<h1 class="page-header">create a payslip</h1>

<ul class="tabs" data-tabs="tabs">
  <li class="active"><%= link_to "express", "#express" %></li>
  <li><%= link_to "custom", "#custom" %></li>
</ul>

<div class="clear"></div>
<%= custom_error_messages @invoice %>
<div id="my-tab-content" class="tab-content">
  <article id="express" class="active express">
    <%= form_for @invoice = Invoice.new do |f| %>
      <%= f.bootstrap_text_field :from, :label => "payment to", :value => current_user.email %>
      <%= f.bootstrap_text_field :description, :label => "description" %>
      <div class="clearfix">
        <%= f.label :amount, "total" %>
        <div class="input">
          <div class="input-prepend">
            <span class="add-on">$</span>
            <%= f.number_field :amount, :class => "mini", :step => "any" %>
          </div>
        </div>
      </div>
      <div class="clearfix">
        <div class="input">
          <%= f.submit "Generate link", :class => "btn info large" %>
        </div>
      </div>
    <% end %>
  </article>

  <article id="custom" class="custom">
    <%= form_for @invoice, :html => { :multipart => true } do |f| %>
      <fieldset>
        <div class="extra add_logo">
          Click here to add a custom logo
        </div>
        <%= f.bootstrap_file_field :logo %>
        <%= f.bootstrap_text_field :from, :label => "payment to", :value => current_user.email %>
        <%= f.bootstrap_text_field :description, :label => "description" %>
        <div class="extra items">
          Click here to itemize.
        </div>
        <ul class="unstyled items" style="margin-top:1em">
          <% 3.times{ @invoice.items.build }%>
          <%= f.fields_for :items do |field| %>
          <li>
            <label>Item</label>
            <%= render :partial => 'item_fields', :locals => {:field => field} %>
            <div class="clear"></div>
          </li>
          <% end %>
        </ul>
        <div class="extra add_item">
          <%= add_item_link "Add item" %>
        </div>
        <div class="clearfix total">
          <%= f.label :amount, "total" %>
          <div class="input">
            <div class="input-prepend">
              <span class="add-on active" style="color:black;font-weight:bold">$</span>
              <%= f.number_field :amount, :class => "small", :step => "any" %>
            </div>
          </div>
        </div>
        <div style="text-align:center"><%= f.submit "Generate link", :class => "btn info large" %></div>
      </fieldset>
    <% end %>
  </article>
</div>

<script type="text/javascript" language="javascript" charset="utf-8">
//<![CDATA[
$(function(){
    hash = window.location.hash;
    console.log("Hash: ", hash);
    if (hash === "#custom") {
        $("a[href=#custom]").click();
    } else if (hash === "#express") {
        $("a[href=#express]").click();
    }
})
  
//]]>
</script>
